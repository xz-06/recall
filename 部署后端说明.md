# ğŸš€ éƒ¨ç½²åç«¯APIæœåŠ¡å™¨è¯´æ˜

GitHub Pagesåªèƒ½éƒ¨ç½²é™æ€ç«™ç‚¹ï¼Œä¸Šä¼ åŠŸèƒ½éœ€è¦å•ç‹¬çš„åç«¯æœåŠ¡å™¨ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©ä½ éƒ¨ç½²åç«¯APIã€‚

## ğŸ“‹ éƒ¨ç½²æ­¥éª¤

### æ–¹å¼1ï¼šRailwayï¼ˆæ¨èï¼Œå…è´¹ï¼‰

#### æ­¥éª¤1ï¼šæ³¨å†ŒRailwayè´¦å·

1. è®¿é—® https://railway.app
2. ä½¿ç”¨GitHubè´¦å·ç™»å½•ï¼ˆæ¨èï¼‰

#### æ­¥éª¤2ï¼šåˆ›å»ºæ–°é¡¹ç›®

1. ç‚¹å‡» **"New Project"**
2. é€‰æ‹© **"Deploy from GitHub repo"**
3. é€‰æ‹©ä½ çš„ä»“åº“ï¼š`xz-06/recall`
4. Railwayä¼šè‡ªåŠ¨æ£€æµ‹Node.jsé¡¹ç›®

#### æ­¥éª¤3ï¼šé…ç½®ç¯å¢ƒå˜é‡

åœ¨é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ï¼š
```
PORT = 3001
NODE_ENV = production
```

#### æ­¥éª¤4ï¼šéƒ¨ç½²

Railwayä¼šè‡ªåŠ¨ï¼š
- å®‰è£…ä¾èµ–ï¼ˆ`npm install`ï¼‰
- è¿è¡Œå¯åŠ¨å‘½ä»¤ï¼ˆ`npm start`ï¼‰
- åˆ†é…ä¸€ä¸ªåŸŸå

#### æ­¥éª¤5ï¼šè·å–åç«¯åœ°å€

éƒ¨ç½²å®Œæˆåï¼ŒRailwayä¼šæä¾›ä¸€ä¸ªåŸŸåï¼Œä¾‹å¦‚ï¼š
```
https://recall-production.up.railway.app
```

**å¤åˆ¶è¿™ä¸ªåœ°å€ï¼**

#### æ­¥éª¤6ï¼šæ›´æ–°å‰ç«¯é…ç½®

1. **ä¿®æ”¹ `upload.html`**ï¼š
   
   æ‰¾åˆ°è¿™ä¸€è¡Œï¼ˆå¤§çº¦ç¬¬213è¡Œï¼‰ï¼š
   ```javascript
   return 'https://your-backend.railway.app';
   ```
   
   æ›¿æ¢ä¸ºä½ çš„Railwayåœ°å€ï¼š
   ```javascript
   return 'https://recall-production.up.railway.app'; // ä½ çš„å®é™…åœ°å€
   ```

2. **ä¿®æ”¹ `docs/index.md`**ï¼š
   
   æ‰¾åˆ°ä¸Šä¼ é“¾æ¥ï¼Œæ›¿æ¢ä¸ºä½ çš„åç«¯åœ°å€ï¼š
   ```markdown
   [ä¸Šä¼ æ–°å›å¿† :material-plus-circle:](https://ä½ çš„railwayåœ°å€/upload)
   ```

3. **æäº¤å¹¶æ¨é€**ï¼š
   ```bash
   git add upload.html docs/index.md
   git commit -m "é…ç½®ç”Ÿäº§ç¯å¢ƒåç«¯APIåœ°å€"
   git push origin main
   ```

---

### æ–¹å¼2ï¼šRenderï¼ˆå…è´¹ï¼‰

#### æ­¥éª¤1ï¼šæ³¨å†ŒRenderè´¦å·

1. è®¿é—® https://render.com
2. ä½¿ç”¨GitHubè´¦å·ç™»å½•

#### æ­¥éª¤2ï¼šåˆ›å»ºWeb Service

1. ç‚¹å‡» **"New +"** â†’ **"Web Service"**
2. è¿æ¥ä½ çš„GitHubä»“åº“ï¼š`xz-06/recall`

#### æ­¥éª¤3ï¼šé…ç½®æœåŠ¡

- **Name**: `recall-backend`
- **Region**: é€‰æ‹©ç¦»ä½ æœ€è¿‘çš„åŒºåŸŸ
- **Branch**: `main`
- **Root Directory**: ç•™ç©º
- **Environment**: `Node`
- **Build Command**: `npm install`
- **Start Command**: `npm start`

#### æ­¥éª¤4ï¼šæ·»åŠ ç¯å¢ƒå˜é‡

åœ¨ **Environment** éƒ¨åˆ†æ·»åŠ ï¼š
```
NODE_ENV = production
```

#### æ­¥éª¤5ï¼šéƒ¨ç½²

ç‚¹å‡» **"Create Web Service"**ï¼Œç­‰å¾…éƒ¨ç½²å®Œæˆã€‚

#### æ­¥éª¤6ï¼šè·å–åœ°å€å¹¶æ›´æ–°é…ç½®

Renderä¼šæä¾›ä¸€ä¸ªåœ°å€ï¼Œä¾‹å¦‚ï¼š
```
https://recall-backend.onrender.com
```

ç„¶åæŒ‰ç…§Railwayæ–¹å¼çš„æ­¥éª¤6æ›´æ–°å‰ç«¯é…ç½®ã€‚

---

### æ–¹å¼3ï¼šHerokuï¼ˆéœ€è¦ä¿¡ç”¨å¡éªŒè¯ï¼‰

1. è®¿é—® https://heroku.com
2. åˆ›å»ºæ–°åº”ç”¨
3. è¿æ¥GitHubä»“åº“
4. éƒ¨ç½²

---

## âœ… éªŒè¯éƒ¨ç½²

éƒ¨ç½²å®Œæˆåï¼Œæµ‹è¯•åç«¯APIï¼š

```bash
# æµ‹è¯•APIæ˜¯å¦æ­£å¸¸
curl https://ä½ çš„åç«¯åœ°å€/api/upload/memories

# åº”è¯¥è¿”å›JSONæ•°æ®æˆ–ç©ºæ•°ç»„
```

## ğŸ”§ å¸¸è§é—®é¢˜

### Q: åç«¯éƒ¨ç½²åæ— æ³•è®¿é—®ï¼Ÿ

A: 
1. æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®
2. æ£€æŸ¥ `package.json` ä¸­çš„ `start` è„šæœ¬
3. æŸ¥çœ‹Railway/Renderçš„æ—¥å¿—

### Q: CORSé”™è¯¯ï¼Ÿ

A: 
åç«¯å·²ç»é…ç½®äº†CORSï¼Œå¦‚æœè¿˜æœ‰é—®é¢˜ï¼š
1. æ£€æŸ¥ `server/index.js` ä¸­çš„CORSé…ç½®
2. ç¡®ä¿å‰ç«¯åœ°å€åœ¨åç«¯CORSå…è®¸åˆ—è¡¨ä¸­

### Q: å¦‚ä½•æ›´æ–°åç«¯ä»£ç ï¼Ÿ

A: 
```bash
# ä¿®æ”¹ä»£ç å
git add .
git commit -m "æ›´æ–°åç«¯ä»£ç "
git push origin main

# Railway/Renderä¼šè‡ªåŠ¨é‡æ–°éƒ¨ç½²
```

### Q: åç«¯åœ°å€åœ¨å“ªé‡ŒæŸ¥çœ‹ï¼Ÿ

A: 
- **Railway**: é¡¹ç›®é¡µé¢ â†’ Settings â†’ Domains
- **Render**: æœåŠ¡é¡µé¢é¡¶éƒ¨æ˜¾ç¤ºçš„URL

---

## ğŸ“ å®Œæ•´é…ç½®ç¤ºä¾‹

å‡è®¾ä½ çš„åç«¯åœ°å€æ˜¯ï¼š`https://recall-backend.up.railway.app`

### 1. ä¿®æ”¹ `upload.html`ï¼ˆç¬¬213è¡Œï¼‰

```javascript
return 'https://recall-backend.up.railway.app';
```

### 2. ä¿®æ”¹ `upload.html`ï¼ˆç¬¬172è¡Œå’Œç¬¬291è¡Œï¼‰

```javascript
// è¿”å›é“¾æ¥
return 'https://xz-06.github.io/recall';

// è·³è½¬åœ°å€
window.location.href = 'https://xz-06.github.io/recall';
```

### 3. ä¿®æ”¹ `docs/index.md`ï¼ˆç¬¬7è¡Œï¼‰

```markdown
[ä¸Šä¼ æ–°å›å¿† :material-plus-circle:](https://recall-backend.up.railway.app/upload)
```

### 4. æäº¤æ›´æ”¹

```bash
git add upload.html docs/index.md
git commit -m "é…ç½®ç”Ÿäº§ç¯å¢ƒAPIåœ°å€"
git push origin main
```

---

## ğŸŒ æ–¹å¼4ï¼šVercel Serverless Functionsï¼ˆæ¨èï¼Œå…è´¹ï¼‰

**ä¼˜ç‚¹**ï¼šå…è´¹ã€è‡ªåŠ¨HTTPSã€å…¨çƒCDNã€æ— éœ€ç®¡ç†æœåŠ¡å™¨

### æ­¥éª¤1ï¼šåˆ›å»ºAPIå‡½æ•°

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `api/upload.js`ï¼š

```javascript
const multer = require('multer');
const FormData = require('form-data');
const fs = require('fs');
const path = require('path');

module.exports = async (req, res) => {
  // è®¾ç½®CORS
  res.setHeader('Access-Control-Allow-Origin', '*');
  res.setHeader('Access-Control-Allow-Methods', 'POST, OPTIONS');
  res.setHeader('Access-Control-Allow-Headers', 'Content-Type');

  if (req.method === 'OPTIONS') {
    return res.status(200).end();
  }

  if (req.method !== 'POST') {
    return res.status(405).json({ error: 'Method not allowed' });
  }

  // å¤„ç†ä¸Šä¼ é€»è¾‘ï¼ˆç®€åŒ–ç‰ˆï¼‰
  // æ³¨æ„ï¼šVercel Functionsæœ‰æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆ50MBï¼‰
  
  try {
    // ä½ çš„ä¸Šä¼ å¤„ç†é€»è¾‘
    res.status(200).json({ success: true, message: 'ä¸Šä¼ æˆåŠŸ' });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
};
```

### æ­¥éª¤2ï¼šéƒ¨ç½²åˆ°Vercel

```bash
# å®‰è£…Vercel CLI
npm install -g vercel

# ç™»å½•
vercel login

# éƒ¨ç½²
vercel --prod
```

### æ­¥éª¤3ï¼šé…ç½®

Vercelä¼šè‡ªåŠ¨åˆ›å»ºAPIè·¯ç”±ï¼š
- `https://your-project.vercel.app/api/upload`

**æ³¨æ„**ï¼šVercel Functionsæœ‰æ‰§è¡Œæ—¶é—´é™åˆ¶ï¼ˆ10ç§’ï¼‰ï¼Œé€‚åˆç®€å•çš„APIã€‚

---

## ğŸŒ æ–¹å¼5ï¼šNetlify Functionsï¼ˆå…è´¹ï¼‰

**ä¼˜ç‚¹**ï¼šå…è´¹ã€è‡ªåŠ¨HTTPSã€ä¸Netlifyå‰ç«¯é›†æˆ

### æ­¥éª¤1ï¼šåˆ›å»ºå‡½æ•°

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `netlify/functions/upload.js`ï¼š

```javascript
exports.handler = async (event, context) => {
  // è®¾ç½®CORS
  const headers = {
    'Access-Control-Allow-Origin': '*',
    'Access-Control-Allow-Headers': 'Content-Type',
    'Access-Control-Allow-Methods': 'POST, OPTIONS',
  };

  if (event.httpMethod === 'OPTIONS') {
    return { statusCode: 200, headers, body: '' };
  }

  // å¤„ç†ä¸Šä¼ é€»è¾‘
  try {
    return {
      statusCode: 200,
      headers,
      body: JSON.stringify({ success: true }),
    };
  } catch (error) {
    return {
      statusCode: 500,
      headers,
      body: JSON.stringify({ error: error.message }),
    };
  }
};
```

### æ­¥éª¤2ï¼šéƒ¨ç½²

è¿æ¥åˆ°Netlifyåï¼Œå‡½æ•°ä¼šè‡ªåŠ¨éƒ¨ç½²ã€‚

**æ³¨æ„**ï¼šNetlify Functionsæœ‰10ç§’æ‰§è¡Œæ—¶é—´é™åˆ¶ã€‚

---

## ğŸŒ æ–¹å¼6ï¼šFly.ioï¼ˆå…è´¹é¢åº¦ï¼‰

**ä¼˜ç‚¹**ï¼šå…¨çƒéƒ¨ç½²ã€Dockeræ”¯æŒã€å…è´¹é¢åº¦å……è¶³

### æ­¥éª¤1ï¼šå®‰è£…Fly CLI

```bash
# Windows
iwr https://fly.io/install.ps1 -useb | iex

# Mac/Linux
curl -L https://fly.io/install.sh | sh
```

### æ­¥éª¤2ï¼šç™»å½•

```bash
fly auth login
```

### æ­¥éª¤3ï¼šåˆ›å»ºåº”ç”¨

```bash
fly launch
```

### æ­¥éª¤4ï¼šéƒ¨ç½²

```bash
fly deploy
```

### æ­¥éª¤5ï¼šè·å–åœ°å€

```bash
fly info
```

---

## ğŸŒ æ–¹å¼7ï¼šCloudflare Workersï¼ˆå…è´¹ï¼‰

**ä¼˜ç‚¹**ï¼šå…¨çƒè¾¹ç¼˜è®¡ç®—ã€å…è´¹é¢åº¦ã€æå¿«é€Ÿåº¦

### æ­¥éª¤1ï¼šå®‰è£…Wrangler CLI

```bash
npm install -g wrangler
```

### æ­¥éª¤2ï¼šç™»å½•

```bash
wrangler login
```

### æ­¥éª¤3ï¼šåˆ›å»ºWorker

åˆ›å»º `worker.js`ï¼š

```javascript
export default {
  async fetch(request) {
    // è®¾ç½®CORS
    const corsHeaders = {
      'Access-Control-Allow-Origin': '*',
      'Access-Control-Allow-Methods': 'POST, OPTIONS',
      'Access-Control-Allow-Headers': 'Content-Type',
    };

    if (request.method === 'OPTIONS') {
      return new Response(null, { headers: corsHeaders });
    }

    // å¤„ç†è¯·æ±‚
    if (request.method === 'POST') {
      const data = await request.json();
      return new Response(JSON.stringify({ success: true }), {
        headers: { ...corsHeaders, 'Content-Type': 'application/json' },
      });
    }

    return new Response('Not Found', { status: 404 });
  },
};
```

### æ­¥éª¤4ï¼šéƒ¨ç½²

```bash
wrangler publish
```

**æ³¨æ„**ï¼šCloudflare Workersæœ‰æ–‡ä»¶å¤§å°é™åˆ¶ï¼Œé€‚åˆAPIä¸é€‚åˆæ–‡ä»¶ä¸Šä¼ ã€‚

---

## ğŸŒ æ–¹å¼8ï¼šè‡ªå»ºVPSæœåŠ¡å™¨ï¼ˆå®Œå…¨æ§åˆ¶ï¼‰

**ä¼˜ç‚¹**ï¼šå®Œå…¨æ§åˆ¶ã€æ— é™åˆ¶ã€å¯è‡ªå®šä¹‰

### æ¨èVPSæä¾›å•†

1. **DigitalOcean**ï¼ˆ$5/æœˆèµ·ï¼‰
   - è®¿é—®ï¼šhttps://www.digitalocean.com
   - ç®€å•æ˜“ç”¨ï¼Œæ–‡æ¡£å®Œå–„

2. **Vultr**ï¼ˆ$2.50/æœˆèµ·ï¼‰
   - è®¿é—®ï¼šhttps://www.vultr.com
   - ä»·æ ¼ä¾¿å®œï¼Œå…¨çƒèŠ‚ç‚¹

3. **Linode**ï¼ˆ$5/æœˆèµ·ï¼‰
   - è®¿é—®ï¼šhttps://www.linode.com
   - ç¨³å®šå¯é 

4. **é˜¿é‡Œäº‘/è…¾è®¯äº‘**ï¼ˆå›½å†…ï¼‰
   - é€‚åˆå›½å†…è®¿é—®
   - éœ€è¦å¤‡æ¡ˆ

### éƒ¨ç½²æ­¥éª¤

1. **è´­ä¹°VPSå¹¶å®‰è£…ç³»ç»Ÿ**ï¼ˆæ¨èUbuntu 22.04ï¼‰

2. **SSHè¿æ¥åˆ°æœåŠ¡å™¨**

3. **å®‰è£…Node.jså’ŒPM2**

```bash
# å®‰è£…Node.js
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# å®‰è£…PM2
sudo npm install -g pm2
```

4. **å…‹éš†ä»£ç **

```bash
git clone https://github.com/xz-06/recall.git
cd recall
npm install
```

5. **é…ç½®ç¯å¢ƒå˜é‡**

```bash
export NODE_ENV=production
export PORT=3001
```

6. **å¯åŠ¨æœåŠ¡**

```bash
pm2 start server/index.js --name recall
pm2 save
pm2 startup
```

7. **é…ç½®Nginxåå‘ä»£ç†**

```bash
sudo apt install nginx
```

åˆ›å»ºé…ç½®æ–‡ä»¶ `/etc/nginx/sites-available/recall`ï¼š

```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:3001;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

8. **é…ç½®SSLï¼ˆHTTPSï¼‰**

```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

---

## ğŸŒ æ–¹å¼9ï¼šä½¿ç”¨GitHub Actionsä½œä¸ºåç«¯ï¼ˆå®éªŒæ€§ï¼‰

**æ³¨æ„**ï¼šè¿™ä¸æ˜¯æ¨èæ–¹æ¡ˆï¼Œä»…ä½œä¸ºå¤‡é€‰ã€‚

### åŸç†

ä½¿ç”¨GitHub Actionsçš„workflow_dispatchè§¦å‘APIè°ƒç”¨ï¼Œé€šè¿‡GitHub APIå­˜å‚¨æ•°æ®ã€‚

**é™åˆ¶**ï¼š
- å“åº”æ…¢ï¼ˆéœ€è¦è§¦å‘workflowï¼‰
- ä¸é€‚åˆå®æ—¶API
- æœ‰APIè°ƒç”¨é™åˆ¶

---

## ğŸŒ æ–¹å¼10ï¼šSupabaseï¼ˆå…è´¹ï¼‰

**ä¼˜ç‚¹**ï¼šå…è´¹ã€PostgreSQLæ•°æ®åº“ã€å®æ—¶åŠŸèƒ½ã€å­˜å‚¨

### æ­¥éª¤1ï¼šæ³¨å†ŒSupabase

1. è®¿é—® https://supabase.com
2. åˆ›å»ºæ–°é¡¹ç›®

### æ­¥éª¤2ï¼šåˆ›å»ºEdge Functions

```bash
# å®‰è£…Supabase CLI
npm install -g supabase

# åˆå§‹åŒ–
supabase init

# åˆ›å»ºå‡½æ•°
supabase functions new upload
```

### æ­¥éª¤3ï¼šéƒ¨ç½²

```bash
supabase functions deploy upload
```

---

## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”æ€»ç»“

| æ–¹æ¡ˆ | è´¹ç”¨ | éš¾åº¦ | æ–‡ä»¶ä¸Šä¼  | æ¨èåº¦ | é€‚åˆåœºæ™¯ |
|------|------|------|----------|--------|----------|
| Railway | å…è´¹é¢åº¦ | â­â­ | âœ… | â­â­â­â­â­ | ç®€å•å¿«é€Ÿ |
| Render | å…è´¹ | â­â­ | âœ… | â­â­â­â­â­ | ç®€å•å¿«é€Ÿ |
| Vercel Functions | å…è´¹ | â­â­â­ | âš ï¸ æœ‰é™åˆ¶ | â­â­â­â­ | è½»é‡API |
| Netlify Functions | å…è´¹ | â­â­â­ | âš ï¸ æœ‰é™åˆ¶ | â­â­â­â­ | ä¸Netlifyé›†æˆ |
| Fly.io | å…è´¹é¢åº¦ | â­â­â­ | âœ… | â­â­â­â­ | Dockeråº”ç”¨ |
| Cloudflare Workers | å…è´¹ | â­â­â­ | âŒ | â­â­â­ | è¾¹ç¼˜è®¡ç®— |
| VPSè‡ªå»º | ä»˜è´¹ | â­â­â­â­ | âœ… | â­â­â­â­â­ | å®Œå…¨æ§åˆ¶ |
| Supabase | å…è´¹ | â­â­â­ | âœ… | â­â­â­â­ | éœ€è¦æ•°æ®åº“ |

---

## ğŸ¯ æ¨èæ–¹æ¡ˆé€‰æ‹©

### æœ€ç®€å•ï¼šRailway æˆ– Render
- âœ… å…è´¹
- âœ… ä¸€é”®éƒ¨ç½²
- âœ… è‡ªåŠ¨HTTPS
- âœ… é€‚åˆå¤§å¤šæ•°åœºæ™¯

### æœ€çµæ´»ï¼šVPSè‡ªå»º
- âœ… å®Œå…¨æ§åˆ¶
- âœ… æ— é™åˆ¶
- âœ… å¯è‡ªå®šä¹‰
- âš ï¸ éœ€è¦ç»´æŠ¤

### æœ€å¿«é€Ÿï¼šVercel/Netlify Functions
- âœ… å…¨çƒCDN
- âœ… è‡ªåŠ¨æ‰©å±•
- âš ï¸ æœ‰æ‰§è¡Œæ—¶é—´é™åˆ¶

### æœ€ç»æµï¼šCloudflare Workers
- âœ… å…è´¹é¢åº¦å¤§
- âœ… å…¨çƒè¾¹ç¼˜
- âŒ ä¸é€‚åˆæ–‡ä»¶ä¸Šä¼ 

---

ğŸ’• æ ¹æ®ä½ çš„éœ€æ±‚é€‰æ‹©æœ€é€‚åˆçš„æ–¹æ¡ˆï¼æ¨èä»Railwayæˆ–Renderå¼€å§‹ã€‚

